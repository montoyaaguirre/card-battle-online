{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/controllers/board-controller.ts","src/core/card.ts","src/core/game-manager.ts","src/core/player.ts","src/main.ts","src/models/board-model.ts","src/views/board-view.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import { Board } from '../models/board-model';\r\nimport { BoardView, CardView } from '../views/board-view';\r\nimport { GameManager, GameState } from '../core/game-manager';\r\n\r\nexport class BoardController {\r\n    private _model: Board;\r\n    private _view: BoardView;\r\n    private _gm: GameManager;\r\n\r\n    public constructor(model: Board, view: BoardView) {\r\n        this._model = model;\r\n        this._view = view;\r\n        this._gm = new GameManager(this._model.player, this._model.oponent);\r\n\r\n        // Bind handlers to view events\r\n        view.setCardClickHandler(this.handleEvent.bind(this));\r\n    }\r\n\r\n    public renderBoard(): void {\r\n        let cards = this._model.getPlayerCards();\r\n        let displayCards: CardView[] = [];\r\n        cards.forEach((card): void => {\r\n            displayCards.push({\r\n                points:card.points,\r\n                type: card.type});\r\n        })\r\n        this._view.renderPlayerCards(displayCards);\r\n        cards = this._model.getOponentCards();\r\n        displayCards = [];\r\n        cards.forEach((card): void => {\r\n            displayCards.push({\r\n                points:card.points,\r\n                type: card.type});\r\n        })\r\n        this._view.renderOponentCards(displayCards);\r\n        this._view.renderPlayerHealth(this._model.getPlayerHealth());\r\n        this._view.renderOponentHealth(this._model.getOponentHealth());\r\n        this._view.renderPlayerShield(this._model.getPlayerShield());\r\n        this._view.renderOponentShield(this._model.getOponentShield());\r\n    }\r\n\r\n    public handleEvent(event: Event): void {\r\n        event.stopPropagation();\r\n        switch(event.type){\r\n            case \"click\":\r\n                this.clickHandler(event.currentTarget as HTMLElement);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    private clickHandler(element: HTMLElement): void{\r\n        if (this._gm.getState() === GameState.playerTurn) {\r\n            this._model.playPlayerCard(parseInt(element.id));\r\n            this.renderBoard();\r\n            this._gm.endPlayerTurn();\r\n            // TODO: Start and wait for Animation\r\n            this._gm.endPlayerAnimation();\r\n            if (this._gm.getState() === GameState.gameOver) {\r\n                this._gameover();\r\n            } else {\r\n                this._oponentTurn();\r\n            }\r\n        }\r\n    }\r\n\r\n    private _oponentTurn(): void {\r\n        if (this._gm.getState() === GameState.oponentTurn) {\r\n            // TODO: get card index from AI\r\n            const cardIndex = 0;\r\n            this._model.playOponentCard(cardIndex);\r\n            this.renderBoard();\r\n            this._gm.endOponentTurn();\r\n            // TODO: Start and wait for Animation\r\n            this._gm.endOponentAnimation();\r\n        }\r\n        if (this._gm.getState() === GameState.gameOver) {\r\n            this._gameover();\r\n        }\r\n    }\r\n\r\n    private _gameover(): void {\r\n        console.log(\"GAME OVER!\");\r\n        this._view.displayGameOutcome(this._model.getPlayerHealth() > 0);\r\n        this._newGame();\r\n    }\r\n\r\n    private _newGame(): void {\r\n        console.log(\"Staring a new game.\");\r\n        this._model.newGame();\r\n        this.renderBoard();\r\n        this._gm.newGame(this._model.player, this._model.oponent);\r\n    }\r\n}\r\n","export enum CardType {\r\n    heal,\r\n    attack,\r\n    shield\r\n}\r\nexport class Card {\r\n    private _points: number;\r\n    private _type: CardType;\r\n\r\n    public constructor(points: number, type: CardType) {\r\n        this._points = points;\r\n        this._type = type;\r\n    }\r\n\r\n    public get points(): number {\r\n        return this._points;\r\n    }\r\n\r\n    public get type(): CardType {\r\n        return this._type;\r\n    }\r\n\r\n    public randomize(): void {\r\n        this._type = this._getRandomCardType();\r\n        if (this._type === CardType.shield) {\r\n            this._points = this._getRandomInt(1, 3);\r\n        } else {\r\n            this._points = this._getRandomInt(1, 4);\r\n        }\r\n    }\r\n\r\n    private _getRandomInt(min: number, max: number): number {\r\n        min = Math.ceil(min);\r\n        max = Math.floor(max);\r\n        return Math.floor(Math.random() * (max - min)) + min;\r\n    }\r\n\r\n    private _getRandomCardType(): CardType {\r\n        const index = this._getRandomInt(0, 5);\r\n        switch (index) {\r\n            case 0:\r\n                return CardType.shield;\r\n            case 1:\r\n                return CardType.heal;\r\n            default:\r\n                return CardType.attack;\r\n        }\r\n    }\r\n}\r\n","import { Player } from './player';\r\n\r\nexport enum GameState {\r\n    paused,\r\n    playerTurn,\r\n    oponentTurn,\r\n    playerAnimation,\r\n    oponentAnimation,\r\n    gameOver\r\n}\r\n\r\nexport class GameManager {\r\n    private _gameState: GameState = GameState.playerTurn;\r\n    private _player: Player;\r\n    private _oponent: Player;\r\n\r\n    public constructor(player: Player, oponent: Player) {\r\n        this.newGame(player, oponent);\r\n    }\r\n\r\n    public getState(): GameState {\r\n        return this._gameState;\r\n    }\r\n\r\n    public endPlayerTurn(): void {\r\n        if ( this._gameState === GameState.playerTurn) {\r\n            this._gameState = GameState.playerAnimation;\r\n        }\r\n    }\r\n\r\n    public endOponentTurn(): void {\r\n        if ( this._gameState === GameState.oponentTurn) {\r\n            this._gameState = GameState.oponentAnimation;\r\n        }\r\n    }\r\n\r\n    public endPlayerAnimation(): void {\r\n        if (this._oponent.health > 0) {\r\n            this._gameState = GameState.oponentTurn;\r\n        } else {\r\n            this._gameState = GameState.gameOver;\r\n        }\r\n    }\r\n\r\n    public endOponentAnimation(): void {\r\n        if (this._player.health > 0) {\r\n            this._gameState = GameState.playerTurn;\r\n        } else {\r\n            this._gameState = GameState.gameOver;\r\n        }\r\n    }\r\n\r\n    public newGame(player: Player, oponent: Player): void {\r\n        this._player = player;\r\n        this._oponent = oponent;\r\n        this._gameState = GameState.playerTurn;\r\n    }\r\n}\r\n","import {Card, CardType} from './card';\r\nimport { Deck } from './deck';\r\n\r\nexport class Player {\r\n    private _maxHealth = 10;\r\n    private _maxShield = 2;\r\n    private _health: number;\r\n    private _shield: number;\r\n    private _cards: Card[];\r\n    private _deck: Deck;\r\n\r\n    public constructor(health: number, shield: number, cards: Card[]) {\r\n        this._health = health;\r\n        this._shield = shield;\r\n        this._cards = this._cloneCards(cards);\r\n    }\r\n\r\n    private _cloneCards(cards: Card[]): Card[] {\r\n        let clones: Card[] = [];\r\n        cards.forEach(function (card): void {\r\n            clones.push(new Card(card.points, card.type));\r\n        });\r\n        return clones;\r\n    }\r\n\r\n    public get health(): number {\r\n        return this._health;\r\n    }\r\n\r\n    public set health(health: number) {\r\n        this._health = health;\r\n        this._health = Math.min(Math.max(this._health, 0), this._maxHealth);\r\n    }\r\n\r\n    public get shield(): number {\r\n        return this._shield;\r\n    }\r\n\r\n    public set shield(shield: number) {\r\n        this._shield = shield;\r\n        this._shield = Math.min(Math.max(this._shield, 0), this._maxShield);\r\n    }\r\n\r\n    public get cards(): Card[] {\r\n        return this._cards;\r\n    }\r\n\r\n    public set cards(cards: Card[]) {\r\n        this._cards = cards;\r\n    }\r\n\r\n    public useCard(index: number): void {\r\n        const card = this._cards[index];\r\n        card.randomize(); // Simulate discarding card and drawing a new one.\r\n    }\r\n\r\n    public applyEffects(card: Card): void {\r\n        switch(card.type) {\r\n            case CardType.heal: {\r\n                this.health += card.points;\r\n                break;\r\n            }\r\n            case CardType.shield: {\r\n                this.shield += card.points;\r\n                break;\r\n            }\r\n            case CardType.attack: {\r\n                this._receiveAttack(card.points);\r\n                break;\r\n            }\r\n            default: {\r\n                console.log(`Card type: '${card.type}' not found.`);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _receiveAttack(points: number): void {\r\n        if (this.shield > 0) {\r\n            this.shield -= points;\r\n        } else {\r\n            this.health -= points;\r\n        }\r\n    }\r\n}\r\n","import { BoardView } from \"./views/board-view\";\r\nimport { BoardController } from \"./controllers/board-controller\";\r\nimport { Board } from \"./models/board-model\";\r\n\r\nconst model = new Board();\r\nconst view = new BoardView();\r\nconst controller = new BoardController(model, view);\r\ncontroller.renderBoard();\r\n","import { Player } from '../core/player';\r\nimport { Card, CardType } from '../core/card';\r\n\r\nexport class Board {\r\n    private _player: Player;\r\n    private _oponent: Player;\r\n\r\n    public constructor() {\r\n        const cards = [\r\n            new Card(3, CardType.heal),\r\n            new Card(1, CardType.shield),\r\n            new Card(1, CardType.attack),\r\n            new Card(3, CardType.attack),\r\n            new Card(2, CardType.shield)\r\n        ]\r\n        this._oponent = new Player(10, 0, cards);\r\n        this._player = new Player(10, 0, cards);\r\n    }\r\n\r\n    public newGame(): void {\r\n        this._oponent.health = 10;\r\n        this._player.health = 10;\r\n        this._oponent.shield = 0;\r\n        this._player.shield = 0;\r\n    }\r\n\r\n    public playPlayerCard(index: number): void {\r\n        const card = this._player.cards[index];\r\n        if(card.type === CardType.attack) {\r\n            this._oponent.applyEffects(card);\r\n        } else {\r\n            this._player.applyEffects(card)\r\n        }\r\n        this._player.useCard(index);\r\n    }\r\n\r\n    public playOponentCard(index: number): void {\r\n        const card = this._oponent.cards[index];\r\n        if(card.type === CardType.attack) {\r\n            this._player.applyEffects(card);\r\n        } else {\r\n            this._oponent.applyEffects(card)\r\n        }\r\n        this._oponent.useCard(index);\r\n    }\r\n\r\n    public getPlayerCards(): Card[] {\r\n        return this._player.cards;\r\n    }\r\n\r\n    public getOponentCards(): Card[] {\r\n        return this._oponent.cards;\r\n    }\r\n\r\n    public getPlayerHealth(): number {\r\n        return this._player.health;\r\n    }\r\n\r\n    public getOponentHealth(): number {\r\n        return this._oponent.health;\r\n    }\r\n\r\n    public getPlayerShield(): number {\r\n        return this._player.shield;\r\n    }\r\n\r\n    public getOponentShield(): number {\r\n        return this._oponent.shield;\r\n    }\r\n\r\n    public get player(): Player {\r\n        return this._player;\r\n    }\r\n\r\n    public get oponent(): Player {\r\n        return this._oponent;\r\n    }\r\n}\r\n","export interface CardView {\r\n    points: number;\r\n    type: number;\r\n}\r\n\r\nexport class BoardView {\r\n    private _cardTypes = [\"‚ù§Ô∏è\", \"‚öîÔ∏è\", \"üõ°Ô∏è\"];\r\n\r\n    public setCardClickHandler(handler: EventListenerObject): void {\r\n        let cards = document.querySelectorAll('#player-cards .card');\r\n        cards.forEach( (element): void => {\r\n            element.addEventListener('click', handler);\r\n        });\r\n    }\r\n\r\n    public renderPlayerHealth(health: number): void {\r\n        this._renderHealth(health, document.querySelector(`#player-health`));\r\n    }\r\n\r\n    public renderOponentHealth(health: number): void {\r\n        this._renderHealth(health, document.querySelector(`#oponent-health`));\r\n    }\r\n\r\n    public renderPlayerCards(cards: CardView[]): void {\r\n        this._renderCards(cards, this._getPlayerCards());\r\n    }\r\n\r\n    public renderOponentCards(cards: CardView[]): void {\r\n        this._renderCards(cards, this._getOponentCards());\r\n    }\r\n\r\n    public renderPlayerShield(shields: number): void {\r\n        this._renderShields(shields, document.querySelector(`#player-shield`));\r\n    }\r\n\r\n    public renderOponentShield(shields: number): void {\r\n        this._renderShields(shields, document.querySelector(`#oponent-shield`));\r\n    }\r\n\r\n    public displayGameOutcome(playerWin: boolean): void {\r\n        playerWin ? window.alert(\"You win!\") : window.alert(\"You lose!\");\r\n    }\r\n\r\n    private _renderCards(cards: CardView[], nodes: NodeListOf<Element>): void {\r\n        for (let i = 0; i < cards.length; i++){\r\n            nodes[i].innerHTML = this._cardTemplate(\r\n                cards[i].points,\r\n                cards[i].type\r\n            );\r\n        }\r\n    }\r\n\r\n    private _renderHealth(health: number, node: Element): void {\r\n        node.innerHTML = this._healthTemplate(health);\r\n    }\r\n\r\n    private _renderShields(shields: number, node: Element): void {\r\n        node.innerHTML = this._shieldTemplate(shields);\r\n    }\r\n\r\n    private _getPlayerCards(): NodeListOf<Element> {\r\n        return this._getCards('player-cards');\r\n    }\r\n\r\n    private _getOponentCards(): NodeListOf<Element> {\r\n        return this._getCards('oponent-cards');\r\n    }\r\n\r\n    private _getCards(containerID: string): NodeListOf<Element> {\r\n        return document.querySelectorAll(`#${containerID} .card`);\r\n    }\r\n\r\n    private _cardTemplate(\r\n        points: number,\r\n        type: number\r\n    ): string {\r\n        let template = \"\";\r\n        const cardLabel = points.toString();\r\n        const cardSuit = this._cardTypes[type];\r\n        template = `\r\n            <div class=\"card-value-top\">${cardLabel}</div>\r\n            <div class=\"card-suit\">${cardSuit}</div>\r\n            <div class=\"card-value-bottom\">${cardLabel}</div>\r\n        `\r\n        return template;\r\n    }\r\n\r\n    private _healthTemplate(\r\n        health: number\r\n    ): string {\r\n        let template = \"\";\r\n        for (let i = 0; i < 10; i++) {\r\n            if (health <= i) {\r\n                template += '<div class=\"health-indicator\">üñ§</div>\\n';\r\n            } else {\r\n                template += '<div class=\"health-indicator\">‚ù§Ô∏è</div>\\n';\r\n            }\r\n        }\r\n        return template;\r\n    }\r\n\r\n    private _shieldTemplate(\r\n        shield: number\r\n    ): string {\r\n        let template = \"\";\r\n        for (let i = 0; i < shield; i++) {\r\n            template += '<div class=\"shield-indicator\">üõ°Ô∏è</div>\\n';\r\n        }\r\n        return template;\r\n    }\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY29udHJvbGxlcnMvYm9hcmQtY29udHJvbGxlci50cyIsInNyYy9jb3JlL2NhcmQudHMiLCJzcmMvY29yZS9nYW1lLW1hbmFnZXIudHMiLCJzcmMvY29yZS9wbGF5ZXIudHMiLCJzcmMvbWFpbi50cyIsInNyYy9tb2RlbHMvYm9hcmQtbW9kZWwudHMiLCJzcmMvdmlld3MvYm9hcmQtdmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7QUNFQSxJQUFBLGlCQUFBLFFBQUEsc0JBQUEsQ0FBQTs7SUFFYSxlO0FBS1QsNkJBQW1CLEtBQW5CLEVBQWlDLElBQWpDLEVBQWdEO0FBQUE7O0FBQzVDLGFBQUssTUFBTCxHQUFjLEtBQWQ7QUFDQSxhQUFLLEtBQUwsR0FBYSxJQUFiO0FBQ0EsYUFBSyxHQUFMLEdBQVcsSUFBSSxlQUFBLFdBQUosQ0FBZ0IsS0FBSyxNQUFMLENBQVksTUFBNUIsRUFBb0MsS0FBSyxNQUFMLENBQVksT0FBaEQsQ0FBWDtBQUVBO0FBQ0EsYUFBSyxtQkFBTCxDQUF5QixLQUFLLFdBQUwsQ0FBaUIsSUFBakIsQ0FBc0IsSUFBdEIsQ0FBekI7QUFDSDs7OztzQ0FFaUI7QUFDZCxnQkFBSSxRQUFRLEtBQUssTUFBTCxDQUFZLGNBQVosRUFBWjtBQUNBLGdCQUFJLGVBQTJCLEVBQS9CO0FBQ0Esa0JBQU0sT0FBTixDQUFjLFVBQUMsSUFBRCxFQUFlO0FBQ3pCLDZCQUFhLElBQWIsQ0FBa0I7QUFDZCw0QkFBTyxLQUFLLE1BREU7QUFFZCwwQkFBTSxLQUFLO0FBRkcsaUJBQWxCO0FBR0gsYUFKRDtBQUtBLGlCQUFLLEtBQUwsQ0FBVyxpQkFBWCxDQUE2QixZQUE3QjtBQUNBLG9CQUFRLEtBQUssTUFBTCxDQUFZLGVBQVosRUFBUjtBQUNBLDJCQUFlLEVBQWY7QUFDQSxrQkFBTSxPQUFOLENBQWMsVUFBQyxJQUFELEVBQWU7QUFDekIsNkJB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LEVBQWE7QUFDakQsaUJBQUssU0FBTCxHQUFpQixLQUFLLGVBQUwsQ0FBcUIsT0FBckIsQ0FBakI7QUFDSDs7OzBDQUVzQjtBQUNuQixtQkFBTyxLQUFLLFNBQUwsQ0FBZSxjQUFmLENBQVA7QUFDSDs7OzJDQUV1QjtBQUNwQixtQkFBTyxLQUFLLFNBQUwsQ0FBZSxlQUFmLENBQVA7QUFDSDs7O2tDQUVpQixXLEVBQW1CO0FBQ2pDLG1CQUFPLFNBQVMsZ0JBQVQsT0FBOEIsV0FBOUIsWUFBUDtBQUNIOzs7c0NBR0csTSxFQUNBLEksRUFBWTtBQUVaLGdCQUFJLFdBQVcsRUFBZjtBQUNBLGdCQUFNLFlBQVksT0FBTyxRQUFQLEVBQWxCO0FBQ0EsZ0JBQU0sV0FBVyxLQUFLLFVBQUwsQ0FBZ0IsSUFBaEIsQ0FBakI7QUFDQSx3RUFDa0MsU0FEbEMscURBRTZCLFFBRjdCLDZEQUdxQyxTQUhyQztBQUtBLG1CQUFPLFFBQVA7QUFDSDs7O3dDQUdHLE0sRUFBYztBQUVkLGdCQUFJLFdBQVcsRUFBZjtBQUNBLGlCQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksRUFBcEIsRUFBd0IsR0FBeEIsRUFBNkI7QUFDekIsb0JBQUksVUFBVSxDQUFkLEVBQWlCO0FBQ2IsZ0NBQVksMENBQVo7QUFDSCxpQkFGRCxNQUVPO0FBQ0gsZ0NBQVksMENBQVo7QUFDSDtBQUNKO0FBQ0QsbUJBQU8sUUFBUDtBQUNIOzs7d0NBR0csTSxFQUFjO0FBRWQsZ0JBQUksV0FBVyxFQUFmO0FBQ0EsaUJBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxNQUFwQixFQUE0QixHQUE1QixFQUFpQztBQUM3Qiw0QkFBWSwyQ0FBWjtBQUNIO0FBQ0QsbUJBQU8sUUFBUDtBQUNIOzs7Ozs7QUF4R0wsUUFBQSxTQUFBLEdBQUEsU0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCB7IEJvYXJkIH0gZnJvbSAnLi4vbW9kZWxzL2JvYXJkLW1vZGVsJztcclxuaW1wb3J0IHsgQm9hcmRWaWV3LCBDYXJkVmlldyB9IGZyb20gJy4uL3ZpZXdzL2JvYXJkLXZpZXcnO1xyXG5pbXBvcnQgeyBHYW1lTWFuYWdlciwgR2FtZVN0YXRlIH0gZnJvbSAnLi4vY29yZS9nYW1lLW1hbmFnZXInO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJvYXJkQ29udHJvbGxlciB7XHJcbiAgICBwcml2YXRlIF9tb2RlbDogQm9hcmQ7XHJcbiAgICBwcml2YXRlIF92aWV3OiBCb2FyZFZpZXc7XHJcbiAgICBwcml2YXRlIF9nbTogR2FtZU1hbmFnZXI7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKG1vZGVsOiBCb2FyZCwgdmlldzogQm9hcmRWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5fbW9kZWwgPSBtb2RlbDtcclxuICAgICAgICB0aGlzLl92aWV3ID0gdmlldztcclxuICAgICAgICB0aGlzLl9nbSA9IG5ldyBHYW1lTWFuYWdlcih0aGlzLl9tb2RlbC5wbGF5ZXIsIHRoaXMuX21vZGVsLm9wb25lbnQpO1xyXG5cclxuICAgICAgICAvLyBCaW5kIGhhbmRsZXJzIHRvIHZpZXcgZXZlbnRzXHJcbiAgICAgICAgdmlldy5zZXRDYXJkQ2xpY2tIYW5kbGVyKHRoaXMuaGFuZGxlRXZlbnQuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlbmRlckJvYXJkKCk6IHZvaWQge1xyXG4gICAgICAgIGxldCBjYXJkcyA9IHRoaXMuX21vZGVsLmdldFBsYXllckNhcmRzKCk7XHJcbiAgICAgICAgbGV0IGRpc3BsYXlDYXJkczogQ2FyZFZpZXdbXSA9IFtdO1xyXG4gICAgICAgIGNhcmRzLmZvckVhY2goKGNhcmQpOiB2b2lkID0+IHtcclxuICAgICAgICAgICAgZGlzcGxheUNhcmRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgcG9pbnRzOmNhcmQucG9pbnRzLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogY2FyZC50eXBlfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICB0aGlzLl92aWV3LnJlbmRlclBsYXllckNhcmRzKGRpc3BsYXlDYXJkcyk7XHJcbiAgICAgICAgY2FyZHMgPSB0aGlzLl9tb2RlbC5nZXRPcG9uZW50Q2FyZHMoKTtcclxuICAgICAgICBkaXNwbGF5Q2FyZHMgPSBbXTtcclxuICAgICAgICBjYXJkcy5mb3JFYWNoKChjYXJkKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlDYXJkcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHBvaW50czpjYXJkLnBvaW50cyxcclxuICAgICAgICAgICAgICAgIHR5cGU6IGNhcmQudHlwZX0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fdmlldy5yZW5kZXJPcG9uZW50Q2FyZHMoZGlzcGxheUNhcmRzKTtcclxuICAgICAgICB0aGlzLl92aWV3LnJlbmRlclBsYXllckhlYWx0aCh0aGlzLl9tb2RlbC5nZXRQbGF5ZXJIZWFsdGgoKSk7XHJcbiAgICAgICAgdGhpcy5fdmlldy5yZW5kZXJPcG9uZW50SGVhbHRoKHRoaXMuX21vZGVsLmdldE9wb25lbnRIZWFsdGgoKSk7XHJcbiAgICAgICAgdGhpcy5fdmlldy5yZW5kZXJQbGF5ZXJTaGllbGQodGhpcy5fbW9kZWwuZ2V0UGxheWVyU2hpZWxkKCkpO1xyXG4gICAgICAgIHRoaXMuX3ZpZXcucmVuZGVyT3BvbmVudFNoaWVsZCh0aGlzLl9tb2RlbC5nZXRPcG9uZW50U2hpZWxkKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBoYW5kbGVFdmVudChldmVudDogRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICBzd2l0Y2goZXZlbnQudHlwZSl7XHJcbiAgICAgICAgICAgIGNhc2UgXCJjbGlja1wiOlxyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGlja0hhbmRsZXIoZXZlbnQuY3VycmVudFRhcmdldCBhcyBIVE1MRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsaWNrSGFuZGxlcihlbGVtZW50OiBIVE1MRWxlbWVudCk6IHZvaWR7XHJcbiAgICAgICAgaWYgKHRoaXMuX2dtLmdldFN0YXRlKCkgPT09IEdhbWVTdGF0ZS5wbGF5ZXJUdXJuKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX21vZGVsLnBsYXlQbGF5ZXJDYXJkKHBhcnNlSW50KGVsZW1lbnQuaWQpKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJCb2FyZCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9nbS5lbmRQbGF5ZXJUdXJuKCk7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IFN0YXJ0IGFuZCB3YWl0IGZvciBBbmltYXRpb25cclxuICAgICAgICAgICAgdGhpcy5fZ20uZW5kUGxheWVyQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9nbS5nZXRTdGF0ZSgpID09PSBHYW1lU3RhdGUuZ2FtZU92ZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2dhbWVvdmVyKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9vcG9uZW50VHVybigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX29wb25lbnRUdXJuKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLl9nbS5nZXRTdGF0ZSgpID09PSBHYW1lU3RhdGUub3BvbmVudFR1cm4pIHtcclxuICAgICAgICAgICAgLy8gVE9ETzogZ2V0IGNhcmQgaW5kZXggZnJvbSBBSVxyXG4gICAgICAgICAgICBjb25zdCBjYXJkSW5kZXggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLl9tb2RlbC5wbGF5T3BvbmVudENhcmQoY2FyZEluZGV4KTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJCb2FyZCgpO1xyXG4gICAgICAgICAgICB0aGlzLl9nbS5lbmRPcG9uZW50VHVybigpO1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBTdGFydCBhbmQgd2FpdCBmb3IgQW5pbWF0aW9uXHJcbiAgICAgICAgICAgIHRoaXMuX2dtLmVuZE9wb25lbnRBbmltYXRpb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuX2dtLmdldFN0YXRlKCkgPT09IEdhbWVTdGF0ZS5nYW1lT3Zlcikge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lb3ZlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nYW1lb3ZlcigpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkdBTUUgT1ZFUiFcIik7XHJcbiAgICAgICAgdGhpcy5fdmlldy5kaXNwbGF5R2FtZU91dGNvbWUodGhpcy5fbW9kZWwuZ2V0UGxheWVySGVhbHRoKCkgPiAwKTtcclxuICAgICAgICB0aGlzLl9uZXdHYW1lKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfbmV3R2FtZSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIlN0YXJpbmcgYSBuZXcgZ2FtZS5cIik7XHJcbiAgICAgICAgdGhpcy5fbW9kZWwubmV3R2FtZSgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQm9hcmQoKTtcclxuICAgICAgICB0aGlzLl9nbS5uZXdHYW1lKHRoaXMuX21vZGVsLnBsYXllciwgdGhpcy5fbW9kZWwub3BvbmVudCk7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGVudW0gQ2FyZFR5cGUge1xyXG4gICAgaGVhbCxcclxuICAgIGF0dGFjayxcclxuICAgIHNoaWVsZFxyXG59XHJcbmV4cG9ydCBjbGFzcyBDYXJkIHtcclxuICAgIHByaXZhdGUgX3BvaW50czogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBfdHlwZTogQ2FyZFR5cGU7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHBvaW50czogbnVtYmVyLCB0eXBlOiBDYXJkVHlwZSkge1xyXG4gICAgICAgIHRoaXMuX3BvaW50cyA9IHBvaW50cztcclxuICAgICAgICB0aGlzLl90eXBlID0gdHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0IHBvaW50cygpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wb2ludHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCB0eXBlKCk6IENhcmRUeXBlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmFuZG9taXplKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0aGlzLl9nZXRSYW5kb21DYXJkVHlwZSgpO1xyXG4gICAgICAgIGlmICh0aGlzLl90eXBlID09PSBDYXJkVHlwZS5zaGllbGQpIHtcclxuICAgICAgICAgICAgdGhpcy5fcG9pbnRzID0gdGhpcy5fZ2V0UmFuZG9tSW50KDEsIDMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3BvaW50cyA9IHRoaXMuX2dldFJhbmRvbUludCgxLCA0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0UmFuZG9tSW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgbWluID0gTWF0aC5jZWlsKG1pbik7XHJcbiAgICAgICAgbWF4ID0gTWF0aC5mbG9vcihtYXgpO1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkgKyBtaW47XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0UmFuZG9tQ2FyZFR5cGUoKTogQ2FyZFR5cGUge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fZ2V0UmFuZG9tSW50KDAsIDUpO1xyXG4gICAgICAgIHN3aXRjaCAoaW5kZXgpIHtcclxuICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENhcmRUeXBlLnNoaWVsZDtcclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENhcmRUeXBlLmhlYWw7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2FyZFR5cGUuYXR0YWNrO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tICcuL3BsYXllcic7XHJcblxyXG5leHBvcnQgZW51bSBHYW1lU3RhdGUge1xyXG4gICAgcGF1c2VkLFxyXG4gICAgcGxheWVyVHVybixcclxuICAgIG9wb25lbnRUdXJuLFxyXG4gICAgcGxheWVyQW5pbWF0aW9uLFxyXG4gICAgb3BvbmVudEFuaW1hdGlvbixcclxuICAgIGdhbWVPdmVyXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBHYW1lTWFuYWdlciB7XHJcbiAgICBwcml2YXRlIF9nYW1lU3RhdGU6IEdhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5wbGF5ZXJUdXJuO1xyXG4gICAgcHJpdmF0ZSBfcGxheWVyOiBQbGF5ZXI7XHJcbiAgICBwcml2YXRlIF9vcG9uZW50OiBQbGF5ZXI7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHBsYXllcjogUGxheWVyLCBvcG9uZW50OiBQbGF5ZXIpIHtcclxuICAgICAgICB0aGlzLm5ld0dhbWUocGxheWVyLCBvcG9uZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0U3RhdGUoKTogR2FtZVN0YXRlIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2FtZVN0YXRlO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBlbmRQbGF5ZXJUdXJuKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICggdGhpcy5fZ2FtZVN0YXRlID09PSBHYW1lU3RhdGUucGxheWVyVHVybikge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdGUgPSBHYW1lU3RhdGUucGxheWVyQW5pbWF0aW9uO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZW5kT3BvbmVudFR1cm4oKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKCB0aGlzLl9nYW1lU3RhdGUgPT09IEdhbWVTdGF0ZS5vcG9uZW50VHVybikge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdGUgPSBHYW1lU3RhdGUub3BvbmVudEFuaW1hdGlvbjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVuZFBsYXllckFuaW1hdGlvbigpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5fb3BvbmVudC5oZWFsdGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2dhbWVTdGF0ZSA9IEdhbWVTdGF0ZS5vcG9uZW50VHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdGUgPSBHYW1lU3RhdGUuZ2FtZU92ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBlbmRPcG9uZW50QW5pbWF0aW9uKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLl9wbGF5ZXIuaGVhbHRoID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdGUgPSBHYW1lU3RhdGUucGxheWVyVHVybjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9nYW1lU3RhdGUgPSBHYW1lU3RhdGUuZ2FtZU92ZXI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBuZXdHYW1lKHBsYXllcjogUGxheWVyLCBvcG9uZW50OiBQbGF5ZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXIgPSBwbGF5ZXI7XHJcbiAgICAgICAgdGhpcy5fb3BvbmVudCA9IG9wb25lbnQ7XHJcbiAgICAgICAgdGhpcy5fZ2FtZVN0YXRlID0gR2FtZVN0YXRlLnBsYXllclR1cm47XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHtDYXJkLCBDYXJkVHlwZX0gZnJvbSAnLi9jYXJkJztcclxuaW1wb3J0IHsgRGVjayB9IGZyb20gJy4vZGVjayc7XHJcblxyXG5leHBvcnQgY2xhc3MgUGxheWVyIHtcclxuICAgIHByaXZhdGUgX21heEhlYWx0aCA9IDEwO1xyXG4gICAgcHJpdmF0ZSBfbWF4U2hpZWxkID0gMjtcclxuICAgIHByaXZhdGUgX2hlYWx0aDogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSBfc2hpZWxkOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIF9jYXJkczogQ2FyZFtdO1xyXG4gICAgcHJpdmF0ZSBfZGVjazogRGVjaztcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoaGVhbHRoOiBudW1iZXIsIHNoaWVsZDogbnVtYmVyLCBjYXJkczogQ2FyZFtdKSB7XHJcbiAgICAgICAgdGhpcy5faGVhbHRoID0gaGVhbHRoO1xyXG4gICAgICAgIHRoaXMuX3NoaWVsZCA9IHNoaWVsZDtcclxuICAgICAgICB0aGlzLl9jYXJkcyA9IHRoaXMuX2Nsb25lQ2FyZHMoY2FyZHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2Nsb25lQ2FyZHMoY2FyZHM6IENhcmRbXSk6IENhcmRbXSB7XHJcbiAgICAgICAgbGV0IGNsb25lczogQ2FyZFtdID0gW107XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaChmdW5jdGlvbiAoY2FyZCk6IHZvaWQge1xyXG4gICAgICAgICAgICBjbG9uZXMucHVzaChuZXcgQ2FyZChjYXJkLnBvaW50cywgY2FyZC50eXBlKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGNsb25lcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0IGhlYWx0aCgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9oZWFsdGg7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBoZWFsdGgoaGVhbHRoOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9oZWFsdGggPSBoZWFsdGg7XHJcbiAgICAgICAgdGhpcy5faGVhbHRoID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5faGVhbHRoLCAwKSwgdGhpcy5fbWF4SGVhbHRoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0IHNoaWVsZCgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9zaGllbGQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBzaGllbGQoc2hpZWxkOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zaGllbGQgPSBzaGllbGQ7XHJcbiAgICAgICAgdGhpcy5fc2hpZWxkID0gTWF0aC5taW4oTWF0aC5tYXgodGhpcy5fc2hpZWxkLCAwKSwgdGhpcy5fbWF4U2hpZWxkKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0IGNhcmRzKCk6IENhcmRbXSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhcmRzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXQgY2FyZHMoY2FyZHM6IENhcmRbXSkge1xyXG4gICAgICAgIHRoaXMuX2NhcmRzID0gY2FyZHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHVzZUNhcmQoaW5kZXg6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLl9jYXJkc1tpbmRleF07XHJcbiAgICAgICAgY2FyZC5yYW5kb21pemUoKTsgLy8gU2ltdWxhdGUgZGlzY2FyZGluZyBjYXJkIGFuZCBkcmF3aW5nIGEgbmV3IG9uZS5cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYXBwbHlFZmZlY3RzKGNhcmQ6IENhcmQpOiB2b2lkIHtcclxuICAgICAgICBzd2l0Y2goY2FyZC50eXBlKSB7XHJcbiAgICAgICAgICAgIGNhc2UgQ2FyZFR5cGUuaGVhbDoge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oZWFsdGggKz0gY2FyZC5wb2ludHM7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIENhcmRUeXBlLnNoaWVsZDoge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaGllbGQgKz0gY2FyZC5wb2ludHM7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIENhcmRUeXBlLmF0dGFjazoge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZUF0dGFjayhjYXJkLnBvaW50cyk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkZWZhdWx0OiB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgQ2FyZCB0eXBlOiAnJHtjYXJkLnR5cGV9JyBub3QgZm91bmQuYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfcmVjZWl2ZUF0dGFjayhwb2ludHM6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLnNoaWVsZCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zaGllbGQgLT0gcG9pbnRzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVhbHRoIC09IHBvaW50cztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQm9hcmRWaWV3IH0gZnJvbSBcIi4vdmlld3MvYm9hcmQtdmlld1wiO1xyXG5pbXBvcnQgeyBCb2FyZENvbnRyb2xsZXIgfSBmcm9tIFwiLi9jb250cm9sbGVycy9ib2FyZC1jb250cm9sbGVyXCI7XHJcbmltcG9ydCB7IEJvYXJkIH0gZnJvbSBcIi4vbW9kZWxzL2JvYXJkLW1vZGVsXCI7XHJcblxyXG5jb25zdCBtb2RlbCA9IG5ldyBCb2FyZCgpO1xyXG5jb25zdCB2aWV3ID0gbmV3IEJvYXJkVmlldygpO1xyXG5jb25zdCBjb250cm9sbGVyID0gbmV3IEJvYXJkQ29udHJvbGxlcihtb2RlbCwgdmlldyk7XHJcbmNvbnRyb2xsZXIucmVuZGVyQm9hcmQoKTtcclxuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSAnLi4vY29yZS9wbGF5ZXInO1xyXG5pbXBvcnQgeyBDYXJkLCBDYXJkVHlwZSB9IGZyb20gJy4uL2NvcmUvY2FyZCc7XHJcblxyXG5leHBvcnQgY2xhc3MgQm9hcmQge1xyXG4gICAgcHJpdmF0ZSBfcGxheWVyOiBQbGF5ZXI7XHJcbiAgICBwcml2YXRlIF9vcG9uZW50OiBQbGF5ZXI7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRzID0gW1xyXG4gICAgICAgICAgICBuZXcgQ2FyZCgzLCBDYXJkVHlwZS5oZWFsKSxcclxuICAgICAgICAgICAgbmV3IENhcmQoMSwgQ2FyZFR5cGUuc2hpZWxkKSxcclxuICAgICAgICAgICAgbmV3IENhcmQoMSwgQ2FyZFR5cGUuYXR0YWNrKSxcclxuICAgICAgICAgICAgbmV3IENhcmQoMywgQ2FyZFR5cGUuYXR0YWNrKSxcclxuICAgICAgICAgICAgbmV3IENhcmQoMiwgQ2FyZFR5cGUuc2hpZWxkKVxyXG4gICAgICAgIF1cclxuICAgICAgICB0aGlzLl9vcG9uZW50ID0gbmV3IFBsYXllcigxMCwgMCwgY2FyZHMpO1xyXG4gICAgICAgIHRoaXMuX3BsYXllciA9IG5ldyBQbGF5ZXIoMTAsIDAsIGNhcmRzKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgbmV3R2FtZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9vcG9uZW50LmhlYWx0aCA9IDEwO1xyXG4gICAgICAgIHRoaXMuX3BsYXllci5oZWFsdGggPSAxMDtcclxuICAgICAgICB0aGlzLl9vcG9uZW50LnNoaWVsZCA9IDA7XHJcbiAgICAgICAgdGhpcy5fcGxheWVyLnNoaWVsZCA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHBsYXlQbGF5ZXJDYXJkKGluZGV4OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBjYXJkID0gdGhpcy5fcGxheWVyLmNhcmRzW2luZGV4XTtcclxuICAgICAgICBpZihjYXJkLnR5cGUgPT09IENhcmRUeXBlLmF0dGFjaykge1xyXG4gICAgICAgICAgICB0aGlzLl9vcG9uZW50LmFwcGx5RWZmZWN0cyhjYXJkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9wbGF5ZXIuYXBwbHlFZmZlY3RzKGNhcmQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3BsYXllci51c2VDYXJkKGluZGV4KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcGxheU9wb25lbnRDYXJkKGluZGV4OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCBjYXJkID0gdGhpcy5fb3BvbmVudC5jYXJkc1tpbmRleF07XHJcbiAgICAgICAgaWYoY2FyZC50eXBlID09PSBDYXJkVHlwZS5hdHRhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyLmFwcGx5RWZmZWN0cyhjYXJkKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9vcG9uZW50LmFwcGx5RWZmZWN0cyhjYXJkKVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9vcG9uZW50LnVzZUNhcmQoaW5kZXgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRQbGF5ZXJDYXJkcygpOiBDYXJkW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9wbGF5ZXIuY2FyZHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldE9wb25lbnRDYXJkcygpOiBDYXJkW10ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vcG9uZW50LmNhcmRzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRQbGF5ZXJIZWFsdGgoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGxheWVyLmhlYWx0aDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0T3BvbmVudEhlYWx0aCgpOiBudW1iZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vcG9uZW50LmhlYWx0aDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UGxheWVyU2hpZWxkKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXllci5zaGllbGQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldE9wb25lbnRTaGllbGQoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3BvbmVudC5zaGllbGQ7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCBwbGF5ZXIoKTogUGxheWVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGxheWVyO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgb3BvbmVudCgpOiBQbGF5ZXIge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vcG9uZW50O1xyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBpbnRlcmZhY2UgQ2FyZFZpZXcge1xyXG4gICAgcG9pbnRzOiBudW1iZXI7XHJcbiAgICB0eXBlOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBCb2FyZFZpZXcge1xyXG4gICAgcHJpdmF0ZSBfY2FyZFR5cGVzID0gW1wi4p2k77iPXCIsIFwi4pqU77iPXCIsIFwi8J+boe+4j1wiXTtcclxuXHJcbiAgICBwdWJsaWMgc2V0Q2FyZENsaWNrSGFuZGxlcihoYW5kbGVyOiBFdmVudExpc3RlbmVyT2JqZWN0KTogdm9pZCB7XHJcbiAgICAgICAgbGV0IGNhcmRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnI3BsYXllci1jYXJkcyAuY2FyZCcpO1xyXG4gICAgICAgIGNhcmRzLmZvckVhY2goIChlbGVtZW50KTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVuZGVyUGxheWVySGVhbHRoKGhlYWx0aDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVySGVhbHRoKGhlYWx0aCwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI3BsYXllci1oZWFsdGhgKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlbmRlck9wb25lbnRIZWFsdGgoaGVhbHRoOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJIZWFsdGgoaGVhbHRoLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjb3BvbmVudC1oZWFsdGhgKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlbmRlclBsYXllckNhcmRzKGNhcmRzOiBDYXJkVmlld1tdKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyQ2FyZHMoY2FyZHMsIHRoaXMuX2dldFBsYXllckNhcmRzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW5kZXJPcG9uZW50Q2FyZHMoY2FyZHM6IENhcmRWaWV3W10pOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJDYXJkcyhjYXJkcywgdGhpcy5fZ2V0T3BvbmVudENhcmRzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW5kZXJQbGF5ZXJTaGllbGQoc2hpZWxkczogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyU2hpZWxkcyhzaGllbGRzLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjcGxheWVyLXNoaWVsZGApKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVuZGVyT3BvbmVudFNoaWVsZChzaGllbGRzOiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJTaGllbGRzKHNoaWVsZHMsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNvcG9uZW50LXNoaWVsZGApKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGlzcGxheUdhbWVPdXRjb21lKHBsYXllcldpbjogYm9vbGVhbik6IHZvaWQge1xyXG4gICAgICAgIHBsYXllcldpbiA/IHdpbmRvdy5hbGVydChcIllvdSB3aW4hXCIpIDogd2luZG93LmFsZXJ0KFwiWW91IGxvc2UhXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3JlbmRlckNhcmRzKGNhcmRzOiBDYXJkVmlld1tdLCBub2RlczogTm9kZUxpc3RPZjxFbGVtZW50Pik6IHZvaWQge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBub2Rlc1tpXS5pbm5lckhUTUwgPSB0aGlzLl9jYXJkVGVtcGxhdGUoXHJcbiAgICAgICAgICAgICAgICBjYXJkc1tpXS5wb2ludHMsXHJcbiAgICAgICAgICAgICAgICBjYXJkc1tpXS50eXBlXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3JlbmRlckhlYWx0aChoZWFsdGg6IG51bWJlciwgbm9kZTogRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIG5vZGUuaW5uZXJIVE1MID0gdGhpcy5faGVhbHRoVGVtcGxhdGUoaGVhbHRoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9yZW5kZXJTaGllbGRzKHNoaWVsZHM6IG51bWJlciwgbm9kZTogRWxlbWVudCk6IHZvaWQge1xyXG4gICAgICAgIG5vZGUuaW5uZXJIVE1MID0gdGhpcy5fc2hpZWxkVGVtcGxhdGUoc2hpZWxkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0UGxheWVyQ2FyZHMoKTogTm9kZUxpc3RPZjxFbGVtZW50PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhcmRzKCdwbGF5ZXItY2FyZHMnKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRPcG9uZW50Q2FyZHMoKTogTm9kZUxpc3RPZjxFbGVtZW50PiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldENhcmRzKCdvcG9uZW50LWNhcmRzJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0Q2FyZHMoY29udGFpbmVySUQ6IHN0cmluZyk6IE5vZGVMaXN0T2Y8RWxlbWVudD4ge1xyXG4gICAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGAjJHtjb250YWluZXJJRH0gLmNhcmRgKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9jYXJkVGVtcGxhdGUoXHJcbiAgICAgICAgcG9pbnRzOiBudW1iZXIsXHJcbiAgICAgICAgdHlwZTogbnVtYmVyXHJcbiAgICApOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCB0ZW1wbGF0ZSA9IFwiXCI7XHJcbiAgICAgICAgY29uc3QgY2FyZExhYmVsID0gcG9pbnRzLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgY29uc3QgY2FyZFN1aXQgPSB0aGlzLl9jYXJkVHlwZXNbdHlwZV07XHJcbiAgICAgICAgdGVtcGxhdGUgPSBgXHJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjYXJkLXZhbHVlLXRvcFwiPiR7Y2FyZExhYmVsfTwvZGl2PlxyXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY2FyZC1zdWl0XCI+JHtjYXJkU3VpdH08L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNhcmQtdmFsdWUtYm90dG9tXCI+JHtjYXJkTGFiZWx9PC9kaXY+XHJcbiAgICAgICAgYFxyXG4gICAgICAgIHJldHVybiB0ZW1wbGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9oZWFsdGhUZW1wbGF0ZShcclxuICAgICAgICBoZWFsdGg6IG51bWJlclxyXG4gICAgKTogc3RyaW5nIHtcclxuICAgICAgICBsZXQgdGVtcGxhdGUgPSBcIlwiO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaGVhbHRoIDw9IGkpIHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlICs9ICc8ZGl2IGNsYXNzPVwiaGVhbHRoLWluZGljYXRvclwiPvCflqQ8L2Rpdj5cXG4nO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGUgKz0gJzxkaXYgY2xhc3M9XCJoZWFsdGgtaW5kaWNhdG9yXCI+4p2k77iPPC9kaXY+XFxuJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfc2hpZWxkVGVtcGxhdGUoXHJcbiAgICAgICAgc2hpZWxkOiBudW1iZXJcclxuICAgICk6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IHRlbXBsYXRlID0gXCJcIjtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoaWVsZDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlICs9ICc8ZGl2IGNsYXNzPVwic2hpZWxkLWluZGljYXRvclwiPvCfm6HvuI88L2Rpdj5cXG4nO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XHJcbiAgICB9XHJcbn1cclxuIl19"}