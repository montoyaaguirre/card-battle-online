{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/controllers/board-controller.ts","src/core/card.ts","src/core/player.ts","src/main.ts","src/models/board-model.ts","src/views/board-view.ts"],"names":[],"mappings":"AAAA;;;;;;;;;ICGa,e;AAIT,6BAAmB,KAAnB,EAAiC,IAAjC,EAAgD;AAAA;;AAC5C,aAAK,MAAL,GAAc,KAAd;AACA,aAAK,KAAL,GAAa,IAAb;AAEA;AACA,aAAK,mBAAL,CAAyB,KAAK,WAAL,CAAiB,IAAjB,CAAsB,IAAtB,CAAzB;AACH;;;;sCAEiB;AACd,gBAAI,QAAQ,KAAK,MAAL,CAAY,cAAZ,EAAZ;AACA,gBAAI,eAA2B,EAA/B;AACA,kBAAM,OAAN,CAAc,UAAC,IAAD,EAAe;AACzB,6BAAa,IAAb,CAAkB;AACd,4BAAO,KAAK,MADE;AAEd,0BAAM,KAAK;AAFG,iBAAlB;AAGH,aAJD;AAKA,iBAAK,KAAL,CAAW,iBAAX,CAA6B,YAA7B;AACA,oBAAQ,KAAK,MAAL,CAAY,eAAZ,EAAR;AACA,2BAAe,EAAf;AACA,kBAAM,OAAN,CAAc,UAAC,IAAD,EAAe;AACzB,6BAAa,IAAb,CAAkB;AACd,4BAAO,KAAK,MADE;AAEd,0BAAM,KAAK;AAFG,iBAAlB;AAGH,aAJD;AAKA,iBAAK,KAAL,CAAW,kBAAX,CAA8B,YAA9B;AACH;;;oCAEkB,K,EAAY;AAC3B,kBAAM,eAAN;AACA,oBAAO,MAAM,IAAb;AACI,qBAAK,OAAL;AACI,yBAAK,YAAL,CAAkB,MAAM,MAAxB;AACA;AACJ;AACI,4BAAQ,GAAR,CAAY,MAAM,MAAlB;AALR;AAOH;;;qCAEoB,O,EAAoB;AACrC,gBAAI,QAAQ,EAAZ,EAAgB;AACZ,qBAAK,MAAL,CAAY,cAAZ,CAA2B,SAAS,QAAQ,EAAjB,CAA3B;AACA,qBAAK,WAAL;AACH;AACJ;;;;;;AA/CL,QAAA,eAAA,GAAA,eAAA;;;;;;;;;;ACHA,IAAY,QAAZ;AAAA,CAAA,UAAY,QAAZ,EAAoB;AAChB,aAAA,SAAA,MAAA,IAAA,CAAA,IAAA,MAAA;AACA,aAAA,SAAA,QAAA,IAAA,CAAA,IAAA,QAAA;AACA,aAAA,SAAA,QAAA,IAAA,CAAA,IAAA,QAAA;AACH,CAJD,EAAY,WAAA,QAAA,QAAA,KAAA,QAAA,QAAA,GAAQ,EAAR,CAAZ;;IAKa,I;AAIT,kBAAmB,MAAnB,EAAmC,IAAnC,EAAiD;AAAA;;AAC7C,aAAK,OAAL,GAAe,MAAf;AACA,aAAK,KAAL,GAAa,IAAb;AACH;;;;oCAUe;AACZ,iBAAK,OAAL,GAAe,KAAK,aAAL,CAAmB,CAAnB,EAAsB,CAAtB,CAAf;AACA,iBAAK,KAAL,GAAa,KAAK,kBAAL,EAAb;AACH;;;sCAEqB,G,EAAa,G,EAAW;AAC1C,kBAAM,KAAK,IAAL,CAAU,GAAV,CAAN;AACA,kBAAM,KAAK,KAAL,CAAW,GAAX,CAAN;AACA,mBAAO,KAAK,KAAL,CAAW,KAAK,MAAL,MAAiB,MAAM,GAAvB,CAAX,IAA0C,GAAjD;AACH;;;6CAEyB;AACtB,gBAAM,QAAQ,KAAK,aAAL,CAAmB,CAAnB,EAAsB,CAAtB,CAAd;AACA,oBAAQ,KAAR;AACI,qBAAK,CAAL;AACI,2BAAO,SAAS,MAAhB;AACJ,qBAAK,CAAL;AACI,2BAAO,SAAS,IAAhB;AACJ;AACI,2BAAO,SAAS,MAAhB;AANR;AAQH;;;4BA7BgB;AACb,mBAAO,KAAK,OAAZ;AACH;;;4BAEc;AACX,mBAAO,KAAK,KAAZ;AACH;;;;;;AAfL,QAAA,IAAA,GAAA,IAAA;;;;;;;;;;ACLA,IAAA,SAAA,QAAA,QAAA,CAAA;;IAGa,M;AAQT,oBAAmB,MAAnB,EAAmC,MAAnC,EAAmD,KAAnD,EAAgE;AAAA;;AAPxD,aAAA,UAAA,GAAa,EAAb;AACA,aAAA,UAAA,GAAa,CAAb;AAOJ,aAAK,OAAL,GAAe,MAAf;AACA,aAAK,OAAL,GAAe,MAAf;AACA,aAAK,MAAL,GAAc,KAAK,WAAL,CAAiB,KAAjB,CAAd;AACH;;;;oCAEmB,K,EAAa;AAC7B,gBAAI,SAAiB,EAArB;AACA,kBAAM,OAAN,CAAc,UAAU,IAAV,EAAc;AACxB,uBAAO,IAAP,CAAY,IAAI,OAAA,IAAJ,CAAS,KAAK,MAAd,EAAsB,KAAK,IAA3B,CAAZ;AACH,aAFD;AAGA,mBAAO,MAAP;AACH;;;gCA4Bc,K,EAAa;AACxB,gBAAM,OAAO,KAAK,MAAL,CAAY,KAAZ,CAAb;AACA,oBAAQ,GAAR,yBAAkC,KAAlC,gBAAkD,KAAK,IAAvD,iBAAuE,KAAK,MAA5E;AACA,iBAAK,SAAL,GAHwB,CAGN;AACrB;;;qCAEmB,I,EAAU;AAC1B,oBAAO,KAAK,IAAZ;AACI,qBAAK,OAAA,QAAA,CAAS,IAAd;AAAoB;AAChB,6BAAK,MAAL,IAAe,KAAK,MAApB;AACA;AACH;AACD,qBAAK,OAAA,QAAA,CAAS,MAAd;AAAsB;AAClB,6BAAK,MAAL,IAAe,KAAK,MAApB;AACA;AACH;AACD,qBAAK,OAAA,QAAA,CAAS,MAAd;AAAsB;AAClB,6BAAK,cAAL,CAAoB,KAAK,MAAzB;AACA;AACH;AACD;AAAS;AACL,gCAAQ,GAAR,kBAA2B,KAAK,IAAhC;AACH;AAfL;AAiBH;;;uCAEsB,M,EAAc;AACjC,gBAAI,KAAK,MAAL,GAAc,CAAlB,EAAqB;AACjB,qBAAK,OAAL,IAAgB,MAAhB;AACH,aAFD,MAEO;AACH,qBAAK,OAAL,IAAgB,MAAhB;AACH;AACJ;;;4BA1DgB;AACb,mBAAO,KAAK,OAAZ;AACH,S;0BAEiB,M,EAAc;AAC5B,iBAAK,OAAL,GAAe,MAAf;AACA,iBAAK,OAAL,GAAe,KAAK,GAAL,CAAS,KAAK,GAAL,CAAS,KAAK,OAAd,EAAuB,CAAvB,CAAT,EAAoC,KAAK,UAAzC,CAAf;AACH;;;4BAEgB;AACb,mBAAO,KAAK,OAAZ;AACH,S;0BAEiB,M,EAAc;AAC5B,iBAAK,OAAL,GAAe,MAAf;AACA,iBAAK,OAAL,GAAe,KAAK,GAAL,CAAS,KAAK,GAAL,CAAS,KAAK,OAAd,EAAuB,CAAvB,CAAT,EAAoC,KAAK,UAAzC,CAAf;AACH;;;4BAEe;AACZ,mBAAO,KAAK,MAAZ;AACH,S;0BAEgB,K,EAAa;AAC1B,iBAAK,MAAL,GAAc,KAAd;AACH;;;;;;AA9CL,QAAA,MAAA,GAAA,MAAA;;;;;;ACHA,IAAA,eAAA,QAAA,oBAAA,CAAA;AACA,IAAA,qBAAA,QAAA,gCAAA,CAAA;AACA,IAAA,gBAAA,QAAA,sBAAA,CAAA;AAEA,IAAM,QAAQ,IAAI,cAAA,KAAJ,EAAd;AACA,IAAM,OAAO,IAAI,aAAA,SAAJ,EAAb;AACA,IAAM,aAAa,IAAI,mBAAA,eAAJ,CAAoB,KAApB,EAA2B,IAA3B,CAAnB;AACA,WAAW,WAAX;;;;;;;;;;ACPA,IAAA,WAAA,QAAA,gBAAA,CAAA;AACA,IAAA,SAAA,QAAA,cAAA,CAAA;;IAEa,K;AAIT,qBAAA;AAAA;;AACI,YAAM,QAAQ,CACV,IAAI,OAAA,IAAJ,CAAS,CAAT,EAAY,OAAA,QAAA,CAAS,IAArB,CADU,EAEV,IAAI,OAAA,IAAJ,CAAS,CAAT,EAAY,OAAA,QAAA,CAAS,MAArB,CAFU,EAGV,IAAI,OAAA,IAAJ,CAAS,CAAT,EAAY,OAAA,QAAA,CAAS,MAArB,CAHU,EAIV,IAAI,OAAA,IAAJ,CAAS,CAAT,EAAY,OAAA,QAAA,CAAS,MAArB,CAJU,EAKV,IAAI,OAAA,IAAJ,CAAS,CAAT,EAAY,OAAA,QAAA,CAAS,MAArB,CALU,CAAd;AAOA,aAAK,OAAL,GAAe,IAAI,SAAA,MAAJ,CAAW,EAAX,EAAe,CAAf,EAAkB,KAAlB,CAAf;AACA,aAAK,QAAL,GAAgB,IAAI,SAAA,MAAJ,CAAW,EAAX,EAAe,CAAf,EAAkB,KAAlB,CAAhB;AACH;;;;uCAEqB,K,EAAa;AAC/B,iBAAK,OAAL,CAAa,OAAb,CAAqB,KAArB;AACA,gBAAM,OAAO,KAAK,OAAL,CAAa,KAAb,CAAmB,KAAnB,CAAb;AACA,gBAAG,KAAK,IAAL,KAAc,OAAA,QAAA,CAAS,MAA1B,EAAkC;AAC9B,qBAAK,QAAL,CAAc,YAAd,CAA2B,IAA3B;AACH,aAFD,MAEO;AACH,qBAAK,OAAL,CAAa,YAAb,CAA0B,IAA1B;AACH;AACD;AACH;;;yCAEoB;AACjB,mBAAO,KAAK,OAAL,CAAa,KAApB;AACH;;;0CAEqB;AAClB,mBAAO,KAAK,QAAL,CAAc,KAArB;AACH;;;;;;AAjCL,QAAA,KAAA,GAAA,KAAA;;;;;;;;;;;ICEa,S;AAAb,yBAAA;AAAA;;AACY,aAAA,UAAA,GAAa,CAAC,IAAD,EAAO,IAAP,EAAa,KAAb,CAAb;AAsDX;;;;4CApD8B,O,EAA4B;AACnD,gBAAI,QAAQ,SAAS,gBAAT,CAA0B,qBAA1B,CAAZ;AACA,kBAAM,OAAN,CAAe,UAAC,OAAD,EAAkB;AAC7B,wBAAQ,gBAAR,CAAyB,OAAzB,EAAkC,OAAlC;AACH,aAFD;AAGH;;;0CAEwB,K,EAAiB;AACtC,iBAAK,YAAL,CAAkB,KAAlB,EAAyB,KAAK,eAAL,EAAzB;AACH;;;2CAEyB,K,EAAiB;AACvC,iBAAK,YAAL,CAAkB,KAAlB,EAAyB,KAAK,gBAAL,EAAzB;AACH;;;qCAEoB,K,EAAmB,K,EAA0B;AAC9D,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,MAAM,MAA1B,EAAkC,GAAlC,EAAsC;AAClC,sBAAM,CAAN,EAAS,SAAT,GAAqB,KAAK,aAAL,CACjB,CADiB,EAEjB,MAAM,CAAN,EAAS,MAFQ,EAGjB,MAAM,CAAN,EAAS,IAHQ,CAArB;AAKH;AACJ;;;0CAEsB;AACnB,mBAAO,KAAK,SAAL,CAAe,cAAf,CAAP;AACH;;;2CAEuB;AACpB,mBAAO,KAAK,SAAL,CAAe,eAAf,CAAP;AACH;;;kCAEiB,W,EAAmB;AACjC,mBAAO,SAAS,gBAAT,OAA8B,WAA9B,YAAP;AACH;;;sCAGG,S,EACA,M,EACA,I,EAAY;AAEZ,gBAAI,WAAW,EAAf;AACA,gBAAM,YAAY,OAAO,QAAP,EAAlB;AACA,gBAAM,WAAW,KAAK,UAAL,CAAgB,IAAhB,CAAjB;AACA,oDACe,SADf,oCACoD,SADpD,sCAEe,SAFf,+BAE+C,QAF/C,sCAGe,SAHf,uCAGuD,SAHvD;AAKA,mBAAO,QAAP;AACH;;;;;;AAtDL,QAAA,SAAA,GAAA,SAAA","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","import { Board } from '../models/board-model';\r\nimport { BoardView, CardView } from '../views/board-view';\r\n\r\nexport class BoardController {\r\n    private _model: Board;\r\n    private _view: BoardView;\r\n\r\n    public constructor(model: Board, view: BoardView) {\r\n        this._model = model;\r\n        this._view = view;\r\n\r\n        // Bind handlers to view events\r\n        view.setCardClickHandler(this.handleEvent.bind(this));\r\n    }\r\n\r\n    public renderBoard(): void {\r\n        let cards = this._model.getPlayerCards();\r\n        let displayCards: CardView[] = [];\r\n        cards.forEach((card): void => {\r\n            displayCards.push({\r\n                points:card.points,\r\n                type: card.type});\r\n        })\r\n        this._view.renderPlayerCards(displayCards);\r\n        cards = this._model.getOponentCards();\r\n        displayCards = [];\r\n        cards.forEach((card): void => {\r\n            displayCards.push({\r\n                points:card.points,\r\n                type: card.type});\r\n        })\r\n        this._view.renderOponentCards(displayCards);\r\n    }\r\n\r\n    public handleEvent(event: Event): void {\r\n        event.stopPropagation();\r\n        switch(event.type){\r\n            case \"click\":\r\n                this.clickHandler(event.target as HTMLElement);\r\n                break;\r\n            default:\r\n                console.log(event.target);\r\n        }\r\n    }\r\n\r\n    private clickHandler(element: HTMLElement): void{\r\n        if (element.id) {\r\n            this._model.playPlayerCard(parseInt(element.id));\r\n            this.renderBoard();\r\n        }\r\n    }\r\n}\r\n","export enum CardType {\r\n    heal,\r\n    attack,\r\n    shield\r\n}\r\nexport class Card {\r\n    private _points: number;\r\n    private _type: CardType;\r\n\r\n    public constructor(points: number, type: CardType) {\r\n        this._points = points;\r\n        this._type = type;\r\n    }\r\n\r\n    public get points(): number {\r\n        return this._points;\r\n    }\r\n\r\n    public get type(): CardType {\r\n        return this._type;\r\n    }\r\n\r\n    public randomize(): void {\r\n        this._points = this._getRandomInt(1, 4);\r\n        this._type = this._getRandomCardType();\r\n    }\r\n\r\n    private _getRandomInt(min: number, max: number): number {\r\n        min = Math.ceil(min);\r\n        max = Math.floor(max);\r\n        return Math.floor(Math.random() * (max - min)) + min;\r\n    }\r\n\r\n    private _getRandomCardType(): CardType {\r\n        const index = this._getRandomInt(0, 3);\r\n        switch (index) {\r\n            case 0:\r\n                return CardType.attack;\r\n            case 1:\r\n                return CardType.heal;\r\n            default:\r\n                return CardType.shield;\r\n        }\r\n    }\r\n}\r\n","import {Card, CardType} from './card';\r\nimport { Deck } from './deck';\r\n\r\nexport class Player {\r\n    private _maxHealth = 10;\r\n    private _maxShield = 2;\r\n    private _health: number;\r\n    private _shield: number;\r\n    private _cards: Card[];\r\n    private _deck: Deck;\r\n\r\n    public constructor(health: number, shield: number, cards: Card[]) {\r\n        this._health = health;\r\n        this._shield = shield;\r\n        this._cards = this._cloneCards(cards);\r\n    }\r\n\r\n    private _cloneCards(cards: Card[]): Card[] {\r\n        let clones: Card[] = [];\r\n        cards.forEach(function (card): void {\r\n            clones.push(new Card(card.points, card.type));\r\n        });\r\n        return clones;\r\n    }\r\n\r\n    public get health(): number {\r\n        return this._health;\r\n    }\r\n\r\n    public set health(health: number) {\r\n        this._health = health;\r\n        this._health = Math.min(Math.max(this._health, 0), this._maxHealth);\r\n    }\r\n\r\n    public get shield(): number {\r\n        return this._shield;\r\n    }\r\n\r\n    public set shield(shield: number) {\r\n        this._shield = shield;\r\n        this._shield = Math.min(Math.max(this._shield, 0), this._maxShield);\r\n    }\r\n\r\n    public get cards(): Card[] {\r\n        return this._cards;\r\n    }\r\n\r\n    public set cards(cards: Card[]) {\r\n        this._cards = cards;\r\n    }\r\n\r\n    public useCard(index: number): void {\r\n        const card = this._cards[index];\r\n        console.log(`Used card at index ${index}\\nType: ${card.type} Points: ${card.points}`);\r\n        card.randomize(); // Simulate discarding card and drawing a new one.\r\n    }\r\n\r\n    public applyEffects(card: Card): void {\r\n        switch(card.type) {\r\n            case CardType.heal: {\r\n                this.health += card.points;\r\n                break;\r\n            }\r\n            case CardType.shield: {\r\n                this.shield += card.points;\r\n                break;\r\n            }\r\n            case CardType.attack: {\r\n                this._receiveAttack(card.points);\r\n                break;\r\n            }\r\n            default: {\r\n                console.log(`Card type: '${card.type}' not found.`);\r\n            }\r\n        }\r\n    }\r\n\r\n    private _receiveAttack(points: number): void {\r\n        if (this.shield > 0) {\r\n            this._shield -= points;\r\n        } else {\r\n            this._health -= points;\r\n        }\r\n    }\r\n}\r\n","import { BoardView } from \"./views/board-view\";\r\nimport { BoardController } from \"./controllers/board-controller\";\r\nimport { Board } from \"./models/board-model\";\r\n\r\nconst model = new Board();\r\nconst view = new BoardView();\r\nconst controller = new BoardController(model, view);\r\ncontroller.renderBoard();\r\n","import { Player } from '../core/player';\r\nimport { Card, CardType } from '../core/card';\r\n\r\nexport class Board {\r\n    private _player: Player;\r\n    private _oponent: Player;\r\n\r\n    public constructor() {\r\n        const cards = [\r\n            new Card(3, CardType.heal),\r\n            new Card(1, CardType.shield),\r\n            new Card(1, CardType.attack),\r\n            new Card(3, CardType.attack),\r\n            new Card(2, CardType.shield)\r\n        ]\r\n        this._player = new Player(10, 0, cards);\r\n        this._oponent = new Player(10, 0, cards);\r\n    }\r\n\r\n    public playPlayerCard(index: number): void {\r\n        this._player.useCard(index);\r\n        const card = this._player.cards[index];\r\n        if(card.type === CardType.attack) {\r\n            this._oponent.applyEffects(card);\r\n        } else {\r\n            this._player.applyEffects(card)\r\n        }\r\n        // Emit change in cards for view update\r\n    }\r\n\r\n    public getPlayerCards(): Card[] {\r\n        return this._player.cards;\r\n    }\r\n\r\n    public getOponentCards(): Card[] {\r\n        return this._oponent.cards;\r\n    }\r\n}\r\n","export interface CardView {\r\n    points: number;\r\n    type: number;\r\n}\r\n\r\nexport class BoardView {\r\n    private _cardTypes = [\"❤️\", \"⚔️\", \"🛡️\"];\r\n\r\n    public setCardClickHandler(handler: EventListenerObject): void {\r\n        let cards = document.querySelectorAll('#player-cards .card');\r\n        cards.forEach( (element): void => {\r\n            element.addEventListener('click', handler);\r\n        });\r\n    }\r\n\r\n    public renderPlayerCards(cards: CardView[]): void {\r\n        this._renderCards(cards, this._getPlayerCards());\r\n    }\r\n\r\n    public renderOponentCards(cards: CardView[]): void {\r\n        this._renderCards(cards, this._getOponentCards());\r\n    }\r\n\r\n    private _renderCards(cards: CardView[], nodes: NodeListOf<Element>): void {\r\n        for (let i = 0; i < cards.length; i++){\r\n            nodes[i].innerHTML = this._cardTemplate(\r\n                i,\r\n                cards[i].points,\r\n                cards[i].type\r\n            );\r\n        }\r\n    }\r\n\r\n    private _getPlayerCards(): NodeListOf<Element> {\r\n        return this._getCards('player-cards');\r\n    }\r\n\r\n    private _getOponentCards(): NodeListOf<Element> {\r\n        return this._getCards('oponent-cards');\r\n    }\r\n\r\n    private _getCards(containerID: string): NodeListOf<Element> {\r\n        return document.querySelectorAll(`#${containerID} .card`);\r\n    }\r\n\r\n    private _cardTemplate(\r\n        cardindex: number,\r\n        points: number,\r\n        type: number\r\n    ): string {\r\n        let template = \"\";\r\n        const cardLabel = points.toString();\r\n        const cardSuit = this._cardTypes[type];\r\n        template = `\r\n            <div id=\"${cardindex}\" class=\"card-value-top\">${cardLabel}</div>\r\n            <div id=\"${cardindex}\" class=\"card-suit\">${cardSuit}</div>\r\n            <div id=\"${cardindex}\" class=\"card-value-bottom\">${cardLabel}</div>\r\n        `\r\n        return template;\r\n    }\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY29udHJvbGxlcnMvYm9hcmQtY29udHJvbGxlci50cyIsInNyYy9jb3JlL2NhcmQudHMiLCJzcmMvY29yZS9wbGF5ZXIudHMiLCJzcmMvbWFpbi50cyIsInNyYy9tb2RlbHMvYm9hcmQtbW9kZWwudHMiLCJzcmMvdmlld3MvYm9hcmQtdmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7O0lDR2EsZTtBQUlULDZCQUFtQixLQUFuQixFQUFpQyxJQUFqQyxFQUFnRDtBQUFBOztBQUM1QyxhQUFLLE1BQUwsR0FBYyxLQUFkO0FBQ0EsYUFBSyxLQUFMLEdBQWEsSUFBYjtBQUVBO0FBQ0EsYUFBSyxtQkFBTCxDQUF5QixLQUFLLFdBQUwsQ0FBaUIsSUFBakIsQ0FBc0IsSUFBdEIsQ0FBekI7QUFDSDs7OztzQ0FFaUI7QUFDZCxnQkFBSSxRQUFRLEtBQUssTUFBTCxDQUFZLGNBQVosRUFBWjtBQUNBLGdCQUFJLGVBQTJCLEVBQS9CO0FBQ0Esa0JBQU0sT0FBTixDQUFjLFVBQUMsSUFBRCxFQUFlO0FBQ3pCLDZCQUFhLElBQWIsQ0FBa0I7QUFDZCw0QkFBTyxLQUFLLE1BREU7QUFFZCwwQkFBTSxLQUFLO0FBRkcsaUJBQWxCO0FBR0gsYUFKRDtBQUtBLGlCQUFLLEtBQUwsQ0FBVyxpQkFBWCxDQUE2QixZQUE3QjtBQUNBLG9CQUFRLEtBQUssTUFBTCxDQUFZLGVBQVosRUFBUjtBQUNBLDJCQUFlLEVBQWY7QUFDQSxrQkFBTSxPQUFOLENBQWMsVUFBQyxJQUFELEVBQWU7QUFDekIsNkJBQWEsSUFBYixDQUFrQjtBQUNkLDRCQUFPLEtBQUssTUFERTtBQUVkLDBCQUFNLEtBQUs7QUFGRyxpQkFBbEI7QUFHSCxhQUpEO0FBS0EsaUJBQUssS0FBTCxDQUFXLGtCQUFYLENBQThCLFlBQTlCO0FBQ0g7OztvQ0FFa0IsSyxFQUFZO0FBQzNCLGtCQUFNLGVBQU47QUFD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LE1BQU0sQ0FBTixFQUFTLE1BRlEsRUFHakIsTUFBTSxDQUFOLEVBQVMsSUFIUSxDQUFyQjtBQUtIO0FBQ0o7OzswQ0FFc0I7QUFDbkIsbUJBQU8sS0FBSyxTQUFMLENBQWUsY0FBZixDQUFQO0FBQ0g7OzsyQ0FFdUI7QUFDcEIsbUJBQU8sS0FBSyxTQUFMLENBQWUsZUFBZixDQUFQO0FBQ0g7OztrQ0FFaUIsVyxFQUFtQjtBQUNqQyxtQkFBTyxTQUFTLGdCQUFULE9BQThCLFdBQTlCLFlBQVA7QUFDSDs7O3NDQUdHLFMsRUFDQSxNLEVBQ0EsSSxFQUFZO0FBRVosZ0JBQUksV0FBVyxFQUFmO0FBQ0EsZ0JBQU0sWUFBWSxPQUFPLFFBQVAsRUFBbEI7QUFDQSxnQkFBTSxXQUFXLEtBQUssVUFBTCxDQUFnQixJQUFoQixDQUFqQjtBQUNBLG9EQUNlLFNBRGYsb0NBQ29ELFNBRHBELHNDQUVlLFNBRmYsK0JBRStDLFFBRi9DLHNDQUdlLFNBSGYsdUNBR3VELFNBSHZEO0FBS0EsbUJBQU8sUUFBUDtBQUNIOzs7Ozs7QUF0REwsUUFBQSxTQUFBLEdBQUEsU0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImltcG9ydCB7IEJvYXJkIH0gZnJvbSAnLi4vbW9kZWxzL2JvYXJkLW1vZGVsJztcclxuaW1wb3J0IHsgQm9hcmRWaWV3LCBDYXJkVmlldyB9IGZyb20gJy4uL3ZpZXdzL2JvYXJkLXZpZXcnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJvYXJkQ29udHJvbGxlciB7XHJcbiAgICBwcml2YXRlIF9tb2RlbDogQm9hcmQ7XHJcbiAgICBwcml2YXRlIF92aWV3OiBCb2FyZFZpZXc7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKG1vZGVsOiBCb2FyZCwgdmlldzogQm9hcmRWaWV3KSB7XHJcbiAgICAgICAgdGhpcy5fbW9kZWwgPSBtb2RlbDtcclxuICAgICAgICB0aGlzLl92aWV3ID0gdmlldztcclxuXHJcbiAgICAgICAgLy8gQmluZCBoYW5kbGVycyB0byB2aWV3IGV2ZW50c1xyXG4gICAgICAgIHZpZXcuc2V0Q2FyZENsaWNrSGFuZGxlcih0aGlzLmhhbmRsZUV2ZW50LmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW5kZXJCb2FyZCgpOiB2b2lkIHtcclxuICAgICAgICBsZXQgY2FyZHMgPSB0aGlzLl9tb2RlbC5nZXRQbGF5ZXJDYXJkcygpO1xyXG4gICAgICAgIGxldCBkaXNwbGF5Q2FyZHM6IENhcmRWaWV3W10gPSBbXTtcclxuICAgICAgICBjYXJkcy5mb3JFYWNoKChjYXJkKTogdm9pZCA9PiB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlDYXJkcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIHBvaW50czpjYXJkLnBvaW50cyxcclxuICAgICAgICAgICAgICAgIHR5cGU6IGNhcmQudHlwZX0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdGhpcy5fdmlldy5yZW5kZXJQbGF5ZXJDYXJkcyhkaXNwbGF5Q2FyZHMpO1xyXG4gICAgICAgIGNhcmRzID0gdGhpcy5fbW9kZWwuZ2V0T3BvbmVudENhcmRzKCk7XHJcbiAgICAgICAgZGlzcGxheUNhcmRzID0gW107XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaCgoY2FyZCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICBkaXNwbGF5Q2FyZHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBwb2ludHM6Y2FyZC5wb2ludHMsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiBjYXJkLnR5cGV9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRoaXMuX3ZpZXcucmVuZGVyT3BvbmVudENhcmRzKGRpc3BsYXlDYXJkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGhhbmRsZUV2ZW50KGV2ZW50OiBFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIHN3aXRjaChldmVudC50eXBlKXtcclxuICAgICAgICAgICAgY2FzZSBcImNsaWNrXCI6XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsaWNrSGFuZGxlcihldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudC50YXJnZXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNsaWNrSGFuZGxlcihlbGVtZW50OiBIVE1MRWxlbWVudCk6IHZvaWR7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQuaWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fbW9kZWwucGxheVBsYXllckNhcmQocGFyc2VJbnQoZWxlbWVudC5pZCkpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckJvYXJkKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImV4cG9ydCBlbnVtIENhcmRUeXBlIHtcclxuICAgIGhlYWwsXHJcbiAgICBhdHRhY2ssXHJcbiAgICBzaGllbGRcclxufVxyXG5leHBvcnQgY2xhc3MgQ2FyZCB7XHJcbiAgICBwcml2YXRlIF9wb2ludHM6IG51bWJlcjtcclxuICAgIHByaXZhdGUgX3R5cGU6IENhcmRUeXBlO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihwb2ludHM6IG51bWJlciwgdHlwZTogQ2FyZFR5cGUpIHtcclxuICAgICAgICB0aGlzLl9wb2ludHMgPSBwb2ludHM7XHJcbiAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldCBwb2ludHMoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcG9pbnRzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgdHlwZSgpOiBDYXJkVHlwZSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJhbmRvbWl6ZSgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9wb2ludHMgPSB0aGlzLl9nZXRSYW5kb21JbnQoMSwgNCk7XHJcbiAgICAgICAgdGhpcy5fdHlwZSA9IHRoaXMuX2dldFJhbmRvbUNhcmRUeXBlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0UmFuZG9tSW50KG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgbWluID0gTWF0aC5jZWlsKG1pbik7XHJcbiAgICAgICAgbWF4ID0gTWF0aC5mbG9vcihtYXgpO1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkgKyBtaW47XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2V0UmFuZG9tQ2FyZFR5cGUoKTogQ2FyZFR5cGUge1xyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fZ2V0UmFuZG9tSW50KDAsIDMpO1xyXG4gICAgICAgIHN3aXRjaCAoaW5kZXgpIHtcclxuICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENhcmRUeXBlLmF0dGFjaztcclxuICAgICAgICAgICAgY2FzZSAxOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENhcmRUeXBlLmhlYWw7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gQ2FyZFR5cGUuc2hpZWxkO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge0NhcmQsIENhcmRUeXBlfSBmcm9tICcuL2NhcmQnO1xyXG5pbXBvcnQgeyBEZWNrIH0gZnJvbSAnLi9kZWNrJztcclxuXHJcbmV4cG9ydCBjbGFzcyBQbGF5ZXIge1xyXG4gICAgcHJpdmF0ZSBfbWF4SGVhbHRoID0gMTA7XHJcbiAgICBwcml2YXRlIF9tYXhTaGllbGQgPSAyO1xyXG4gICAgcHJpdmF0ZSBfaGVhbHRoOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIF9zaGllbGQ6IG51bWJlcjtcclxuICAgIHByaXZhdGUgX2NhcmRzOiBDYXJkW107XHJcbiAgICBwcml2YXRlIF9kZWNrOiBEZWNrO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihoZWFsdGg6IG51bWJlciwgc2hpZWxkOiBudW1iZXIsIGNhcmRzOiBDYXJkW10pIHtcclxuICAgICAgICB0aGlzLl9oZWFsdGggPSBoZWFsdGg7XHJcbiAgICAgICAgdGhpcy5fc2hpZWxkID0gc2hpZWxkO1xyXG4gICAgICAgIHRoaXMuX2NhcmRzID0gdGhpcy5fY2xvbmVDYXJkcyhjYXJkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfY2xvbmVDYXJkcyhjYXJkczogQ2FyZFtdKTogQ2FyZFtdIHtcclxuICAgICAgICBsZXQgY2xvbmVzOiBDYXJkW10gPSBbXTtcclxuICAgICAgICBjYXJkcy5mb3JFYWNoKGZ1bmN0aW9uIChjYXJkKTogdm9pZCB7XHJcbiAgICAgICAgICAgIGNsb25lcy5wdXNoKG5ldyBDYXJkKGNhcmQucG9pbnRzLCBjYXJkLnR5cGUpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gY2xvbmVzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgaGVhbHRoKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlYWx0aDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IGhlYWx0aChoZWFsdGg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX2hlYWx0aCA9IGhlYWx0aDtcclxuICAgICAgICB0aGlzLl9oZWFsdGggPSBNYXRoLm1pbihNYXRoLm1heCh0aGlzLl9oZWFsdGgsIDApLCB0aGlzLl9tYXhIZWFsdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgc2hpZWxkKCk6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NoaWVsZDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IHNoaWVsZChzaGllbGQ6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX3NoaWVsZCA9IHNoaWVsZDtcclxuICAgICAgICB0aGlzLl9zaGllbGQgPSBNYXRoLm1pbihNYXRoLm1heCh0aGlzLl9zaGllbGQsIDApLCB0aGlzLl9tYXhTaGllbGQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXQgY2FyZHMoKTogQ2FyZFtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fY2FyZHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBjYXJkcyhjYXJkczogQ2FyZFtdKSB7XHJcbiAgICAgICAgdGhpcy5fY2FyZHMgPSBjYXJkcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdXNlQ2FyZChpbmRleDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX2NhcmRzW2luZGV4XTtcclxuICAgICAgICBjb25zb2xlLmxvZyhgVXNlZCBjYXJkIGF0IGluZGV4ICR7aW5kZXh9XFxuVHlwZTogJHtjYXJkLnR5cGV9IFBvaW50czogJHtjYXJkLnBvaW50c31gKTtcclxuICAgICAgICBjYXJkLnJhbmRvbWl6ZSgpOyAvLyBTaW11bGF0ZSBkaXNjYXJkaW5nIGNhcmQgYW5kIGRyYXdpbmcgYSBuZXcgb25lLlxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhcHBseUVmZmVjdHMoY2FyZDogQ2FyZCk6IHZvaWQge1xyXG4gICAgICAgIHN3aXRjaChjYXJkLnR5cGUpIHtcclxuICAgICAgICAgICAgY2FzZSBDYXJkVHlwZS5oZWFsOiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhlYWx0aCArPSBjYXJkLnBvaW50cztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgQ2FyZFR5cGUuc2hpZWxkOiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNoaWVsZCArPSBjYXJkLnBvaW50cztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgQ2FyZFR5cGUuYXR0YWNrOiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWNlaXZlQXR0YWNrKGNhcmQucG9pbnRzKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBDYXJkIHR5cGU6ICcke2NhcmQudHlwZX0nIG5vdCBmb3VuZC5gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9yZWNlaXZlQXR0YWNrKHBvaW50czogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgaWYgKHRoaXMuc2hpZWxkID4gMCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zaGllbGQgLT0gcG9pbnRzO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYWx0aCAtPSBwb2ludHM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IEJvYXJkVmlldyB9IGZyb20gXCIuL3ZpZXdzL2JvYXJkLXZpZXdcIjtcclxuaW1wb3J0IHsgQm9hcmRDb250cm9sbGVyIH0gZnJvbSBcIi4vY29udHJvbGxlcnMvYm9hcmQtY29udHJvbGxlclwiO1xyXG5pbXBvcnQgeyBCb2FyZCB9IGZyb20gXCIuL21vZGVscy9ib2FyZC1tb2RlbFwiO1xyXG5cclxuY29uc3QgbW9kZWwgPSBuZXcgQm9hcmQoKTtcclxuY29uc3QgdmlldyA9IG5ldyBCb2FyZFZpZXcoKTtcclxuY29uc3QgY29udHJvbGxlciA9IG5ldyBCb2FyZENvbnRyb2xsZXIobW9kZWwsIHZpZXcpO1xyXG5jb250cm9sbGVyLnJlbmRlckJvYXJkKCk7XHJcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gJy4uL2NvcmUvcGxheWVyJztcclxuaW1wb3J0IHsgQ2FyZCwgQ2FyZFR5cGUgfSBmcm9tICcuLi9jb3JlL2NhcmQnO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJvYXJkIHtcclxuICAgIHByaXZhdGUgX3BsYXllcjogUGxheWVyO1xyXG4gICAgcHJpdmF0ZSBfb3BvbmVudDogUGxheWVyO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBjb25zdCBjYXJkcyA9IFtcclxuICAgICAgICAgICAgbmV3IENhcmQoMywgQ2FyZFR5cGUuaGVhbCksXHJcbiAgICAgICAgICAgIG5ldyBDYXJkKDEsIENhcmRUeXBlLnNoaWVsZCksXHJcbiAgICAgICAgICAgIG5ldyBDYXJkKDEsIENhcmRUeXBlLmF0dGFjayksXHJcbiAgICAgICAgICAgIG5ldyBDYXJkKDMsIENhcmRUeXBlLmF0dGFjayksXHJcbiAgICAgICAgICAgIG5ldyBDYXJkKDIsIENhcmRUeXBlLnNoaWVsZClcclxuICAgICAgICBdXHJcbiAgICAgICAgdGhpcy5fcGxheWVyID0gbmV3IFBsYXllcigxMCwgMCwgY2FyZHMpO1xyXG4gICAgICAgIHRoaXMuX29wb25lbnQgPSBuZXcgUGxheWVyKDEwLCAwLCBjYXJkcyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHBsYXlQbGF5ZXJDYXJkKGluZGV4OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9wbGF5ZXIudXNlQ2FyZChpbmRleCk7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX3BsYXllci5jYXJkc1tpbmRleF07XHJcbiAgICAgICAgaWYoY2FyZC50eXBlID09PSBDYXJkVHlwZS5hdHRhY2spIHtcclxuICAgICAgICAgICAgdGhpcy5fb3BvbmVudC5hcHBseUVmZmVjdHMoY2FyZCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fcGxheWVyLmFwcGx5RWZmZWN0cyhjYXJkKVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBFbWl0IGNoYW5nZSBpbiBjYXJkcyBmb3IgdmlldyB1cGRhdGVcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0UGxheWVyQ2FyZHMoKTogQ2FyZFtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcGxheWVyLmNhcmRzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBnZXRPcG9uZW50Q2FyZHMoKTogQ2FyZFtdIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fb3BvbmVudC5jYXJkcztcclxuICAgIH1cclxufVxyXG4iLCJleHBvcnQgaW50ZXJmYWNlIENhcmRWaWV3IHtcclxuICAgIHBvaW50czogbnVtYmVyO1xyXG4gICAgdHlwZTogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQm9hcmRWaWV3IHtcclxuICAgIHByaXZhdGUgX2NhcmRUeXBlcyA9IFtcIuKdpO+4j1wiLCBcIuKalO+4j1wiLCBcIvCfm6HvuI9cIl07XHJcblxyXG4gICAgcHVibGljIHNldENhcmRDbGlja0hhbmRsZXIoaGFuZGxlcjogRXZlbnRMaXN0ZW5lck9iamVjdCk6IHZvaWQge1xyXG4gICAgICAgIGxldCBjYXJkcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJyNwbGF5ZXItY2FyZHMgLmNhcmQnKTtcclxuICAgICAgICBjYXJkcy5mb3JFYWNoKCAoZWxlbWVudCk6IHZvaWQgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlbmRlclBsYXllckNhcmRzKGNhcmRzOiBDYXJkVmlld1tdKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyQ2FyZHMoY2FyZHMsIHRoaXMuX2dldFBsYXllckNhcmRzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW5kZXJPcG9uZW50Q2FyZHMoY2FyZHM6IENhcmRWaWV3W10pOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9yZW5kZXJDYXJkcyhjYXJkcywgdGhpcy5fZ2V0T3BvbmVudENhcmRzKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3JlbmRlckNhcmRzKGNhcmRzOiBDYXJkVmlld1tdLCBub2RlczogTm9kZUxpc3RPZjxFbGVtZW50Pik6IHZvaWQge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY2FyZHMubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICBub2Rlc1tpXS5pbm5lckhUTUwgPSB0aGlzLl9jYXJkVGVtcGxhdGUoXHJcbiAgICAgICAgICAgICAgICBpLFxyXG4gICAgICAgICAgICAgICAgY2FyZHNbaV0ucG9pbnRzLFxyXG4gICAgICAgICAgICAgICAgY2FyZHNbaV0udHlwZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRQbGF5ZXJDYXJkcygpOiBOb2RlTGlzdE9mPEVsZW1lbnQ+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FyZHMoJ3BsYXllci1jYXJkcycpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2dldE9wb25lbnRDYXJkcygpOiBOb2RlTGlzdE9mPEVsZW1lbnQ+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q2FyZHMoJ29wb25lbnQtY2FyZHMnKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRDYXJkcyhjb250YWluZXJJRDogc3RyaW5nKTogTm9kZUxpc3RPZjxFbGVtZW50PiB7XHJcbiAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCMke2NvbnRhaW5lcklEfSAuY2FyZGApO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2NhcmRUZW1wbGF0ZShcclxuICAgICAgICBjYXJkaW5kZXg6IG51bWJlcixcclxuICAgICAgICBwb2ludHM6IG51bWJlcixcclxuICAgICAgICB0eXBlOiBudW1iZXJcclxuICAgICk6IHN0cmluZyB7XHJcbiAgICAgICAgbGV0IHRlbXBsYXRlID0gXCJcIjtcclxuICAgICAgICBjb25zdCBjYXJkTGFiZWwgPSBwb2ludHMudG9TdHJpbmcoKTtcclxuICAgICAgICBjb25zdCBjYXJkU3VpdCA9IHRoaXMuX2NhcmRUeXBlc1t0eXBlXTtcclxuICAgICAgICB0ZW1wbGF0ZSA9IGBcclxuICAgICAgICAgICAgPGRpdiBpZD1cIiR7Y2FyZGluZGV4fVwiIGNsYXNzPVwiY2FyZC12YWx1ZS10b3BcIj4ke2NhcmRMYWJlbH08L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBpZD1cIiR7Y2FyZGluZGV4fVwiIGNsYXNzPVwiY2FyZC1zdWl0XCI+JHtjYXJkU3VpdH08L2Rpdj5cclxuICAgICAgICAgICAgPGRpdiBpZD1cIiR7Y2FyZGluZGV4fVwiIGNsYXNzPVwiY2FyZC12YWx1ZS1ib3R0b21cIj4ke2NhcmRMYWJlbH08L2Rpdj5cclxuICAgICAgICBgXHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xyXG4gICAgfVxyXG59XHJcbiJdfQ=="}